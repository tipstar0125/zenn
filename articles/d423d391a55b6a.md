---
title: "ã€AHCã€‘Rustã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒãƒ³ãƒ‰ãƒ«ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œã£ã¦ã¿ãŸ"
emoji: "ğŸƒ"
type: "tech"
topics: ["rust", "AtCoder"]
published: true
---

é•·æœŸã®AHCã«å‚åŠ ã—ã¦ã„ã‚‹ã¨ã€ã‚³ãƒ¼ãƒ‰ãŒã©ã‚“ã©ã‚“è‚¥å¤§åŒ–ã—ã¦ã„ã£ã¦ã€æå‡ºã®ãŸã‚ã«å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚³ãƒ¼ãƒ‰æ›¸ãã®ãŒçµæ§‹ã—ã‚“ã©ã„ã§ã™ã€‚
ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¯ã«ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ããŸããªã‚‹ã®ã§ã™ãŒã€æ‰‹å‹•ã§å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¾ã¨ã‚ã‚‹ã®ã‚‚å¤§åˆ†ã—ã‚“ã©ã„ã§ã™ã€‚
ã“ã‚Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«`cargo equip`ã‚’ä½¿ç”¨ã™ã‚‹æ‰‹ãŒã‚ã‚‹ã®ã§ã™ãŒã€ä»¥ä¸‹ã®ç†ç”±ã‹ã‚‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è‡ªä½œã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚
- ä½¿ã„æ–¹ã«ç™–ãŒã‚ã‚Šãã†ã€‚å®Ÿéš›ä½¿ã£ã¦ãªã„ã®ã§ã€ãã†ã§ã¯ãªã„ã‹ã‚‚ã—ã‚Œãªã„ãŒã€ä½¿ã„æ–¹ã«æ…£ã‚Œã‚‹ãã‚‰ã„ãªã‚‰è‡ªä½œã—ãŸæ–¹ãŒæ—©ãã†ã€‚
- è‡ªç”±åº¦ãŒã»ã—ã„ã€‚ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¶ã®ã‚³ãƒ¼ãƒ‰ã‚‚åŸ‹ã‚è¾¼ã‚“ã§ã€ãã®ã¾ã¾æå‡ºã—ãŸã„ã®ã§ã€ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã ã‘ã§å‹•ã‹ã™ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ•ãƒ©ã‚°ã‚’ä»˜ä¸ã—ãŸã„ã€ãªã©ã€‚


ä½œã‚Šã¾ã—ãŸã€‚

```bash
base_file=./src/bin/$1.rs
submit_file=./src/bin/submit.rs
rm -f $submit_file

# mod xxx; ä»¥å¤–ã‚’æŠœãå‡ºã—ã¦æå‡ºãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ 
cat $base_file | grep -v "^mod*" > $submit_file
# mod xxx; ã‹ã‚‰xxxã‚’æŠ½å‡º
items=(`cat $base_file | grep "^mod*" | sed -E "s/mod (.*);(.*)/\1/"`)

for item in "${items[@]}" ; do
    echo -e "\n" >> $submit_file

    # ã‚ªãƒ—ã‚·ãƒ§ãƒ³
    # ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¶ã®ã‚³ãƒ¼ãƒ‰(vis.mod)ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®ã¿ä½¿ç”¨
    # æå‡ºæ™‚ã«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãªã„ã‚ˆã†ã«ã—ã¦ãŠã
    if [ $item = "vis" ]; then
        echo '#[cfg(feature = "local")]' >> $submit_file
    fi

    echo "mod $item {" >> $submit_file
    cat ./src/bin/$item.rs >> $submit_file
    echo "}" >> $submit_file
done

rustfmt $submit_file

# featuresã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ãƒ­ãƒ¼ã‚«ãƒ«ã§ã¯ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¶ã‚’å‹•ã‹ã™
cargo run -r --bin submit --features local
```

æƒ³å®šã®ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆã¯ä»¥ä¸‹ã®é€šã‚Šã€‚
```
.
|-- Cargo.lock
|-- Cargo.toml
|-- src
|   `-- bin
|       |-- a.rs
|       |-- mod_a.rs
|       |-- mod_b.rs
|       |-- mod_c.rs
|       |-- vis.rs # ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¶ç”¨
|       `-- submit.rs # å‡ºåŠ›ã•ã‚Œã‚‹æå‡ºãƒ•ã‚¡ã‚¤ãƒ«
`-- submit.sh
```

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§æå‡ºãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã€å®Ÿè¡Œã¾ã§è¡Œã„ã¾ã™ã€‚
```bash
bash submit.sh a
```


å…·ä½“ä¾‹ã¯ä»¥ä¸‹ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚
https://github.com/tipstar0125/robotics/blob/master/submit.sh