---
title: "Windows(WSL2) + Ubuntu + Rust + Neovim + fish shell ãƒã‚¤ç«¶ãƒ—ãƒ­ç’°å¢ƒæ§‹ç¯‰"
emoji: ğŸƒ
type: "tech"
topics: ["rust", "AtCoder", "ç«¶ãƒ—ãƒ­"]
published: true
---

# WSL2 ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ä»¥ä¸‹ã«å¾“ã£ã¦ã€WSL2ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚
ãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ãŒã€æŒ‡å®šã—ãªã‘ã‚Œã°`Ubuntu`ãŒæŒ‡å®šã•ã‚Œã‚‹ã®ã§ã€æŒ‡å®šã—ãªã„ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

https://chigusa-web.com/blog/wsl2-win11/


# Windowsã‚¿ãƒ¼ãƒŸãƒŠãƒ« ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Windows11ã®å ´åˆã¯æ¨™æº–æ­è¼‰ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ä¸è¦ã€‚
Windows10ã®å ´åˆã¯ã€ä»¥ä¸‹ã§ç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹é€šã‚Šã€MicroSoft Storeã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

https://se-abeaver.com/install-winterm/


### è¨­å®š

å¥½ã¿ã§ä»¥ä¸‹ã®è¨­å®šã‚’è¡Œã†ã€‚

- ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—æ™‚ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’Ubuntuã«è¨­å®š

[è¨­å®š] -> [ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—] -> [æ—¢å®šã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«]ã§`Ubuntu`ã‚’é¸æŠã—ã€ä¿å­˜ã€‚

![altãƒ†ã‚­ã‚¹ãƒˆ](/images/kyopro_terminal_startup.png)

- èƒŒæ™¯ã®é€æ˜åº¦è¨­å®š

[è¨­å®š] -> ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«æ¬„ã®[Ubuntu-20.04] -> [å¤–è¦³] -> [é€æ˜åº¦]ã§å¥½ã¿ã®é€æ˜åº¦ã«è¨­å®šï¼ˆ70%ãã‚‰ã„ãŒã‚ªã‚¹ã‚¹ãƒ¡ï¼‰ã—ã€ä¿å­˜ã€‚

![altãƒ†ã‚­ã‚¹ãƒˆ](/images/kyopro_terminal_opacity_setting.png)

ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’å†èµ·å‹•ã€ã¾ãŸã¯ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ã‚¿ãƒ–ã‹ã‚‰æ–°ã—ã„ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’èµ·å‹•ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ã€‚

![altãƒ†ã‚­ã‚¹ãƒˆ](/images/kyopro_terminal_opacity.png)


# Rust ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ä»¥ä¸‹ã®é †ã«Windowsã‚¿ãƒ¼ãƒŸãƒŠãƒ«ä¸Šã®`Ubuntu`ã§ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã¤ã€‚
ä»¥ä¸‹ã®è¨˜äº‹ã‚’å‚è€ƒã«ã—ã¾ã—ãŸã€‚

```bash
sudo apt install build-essential
```

```bash
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
```

```bash
echo 'export PATH=$HOME/.cargo/bin:$PATH' | tee -a .bashrc
```

```bash
source .bashrc
```

ä»¥ä¸‹ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèªã§ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°ã€ç„¡äº‹ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¦ã„ã¾ã™ã€‚

```bash
rustup --version
cargo --version
```

### cargo-competeã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

AtCoderã§`cargo-compete`ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã®é€šã‚Šã€‚

```bash
rustup install 1.42.0
```

```bash
cargo install cargo-compete
```

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã‚’è©¦ã—ã¦ã€å†åº¦`cargo-compete`ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è¡Œã†ã€‚

https://qiita.com/nacika_ins/items/465e89a7b3fbeb373605


# Neovim ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

`sudo apt install neovim`ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ãªã‚‰ãªã„ã®ã§ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã—ã¾ã£ãŸå ´åˆã¯ã€`sudo apt remove neovim`ã‚’è¡Œã£ã¦ã‹ã‚‰ã€ä»¥ä¸‹ã®AppImageã®æ‰‹æ³•ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è¡Œã†ã€‚

https://github.com/neovim/neovim/wiki/Installing-Neovim#appimage-universal-linux-package

```bash
curl -LO https://github.com/neovim/neovim/releases/latest/download/nvim.appimage
```

```bash
chmod u+x nvim.appimage
```

```bash
./nvim.appimage
```

```bash
./nvim.appimage --appimage-extract
```

```bash
./squashfs-root/AppRun --version
```

```bash
sudo mv squashfs-root /
```

```bash
sudo ln -s /squashfs-root/AppRun /usr/bin/nvim
```

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèªã—ã¦ã€æ­£å¸¸ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚

```bash
nvim -v
```

### rustfmt

è‡ªå‹•æ•´å½¢ã—ãŸã„å ´åˆã¯ã€`rustfmt`ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

```bash
rustup component add rustfmt
```

### Node.js ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

rust-analyzerã‚’ä½¿ã†ãŸã‚ã«coc.nvimãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§ã€Node.jsãŒå¿…è¦ãªã®ã§ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

```bash
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
```

```bash
sudo apt-get install -y nodejs
```

```bash
sudo npm install -g yarn
```

```bash
sudo npm install n -g
```

```bash
sudo n latest
```

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã€‚ã‚«ãƒ¼ã‚½ãƒ«ã‚­ãƒ¼ã§é¸æŠã—ãƒªã‚¿ãƒ¼ãƒ³ã‚­ãƒ¼ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™ã€‚

```bash
sudo n
```

ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’å†èµ·å‹•å¾Œã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§æœ€æ–°ç‰ˆã®Node.jsãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚

```bash
node -v
```

### vim-plug ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
sh -c 'curl -fLo "${XDG_DATA_HOME:-$HOME/.local/share}"/nvim/site/autoload/plug.vim --create-dirs \
       https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim'
```

- init.vimä½œæˆ

Neovimã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã‹ã‚‰ã€`init.vim`ã®è¨­å®šã‚’ã—ã¦ã„ãªã„å ´åˆã¯ã€`~/.config/nvim/init.vim`ã‚’æ‰‹å‹•ã§ä½œæˆã—ã€ä»¥ä¸‹ã®å†…å®¹ã‚’å…¥åŠ›ã—ã€ä¿å­˜ã™ã‚‹ã€‚

```vim
call plug#begin('~/.vim/plugged')
  Plug 'rust-lang/rust.vim'
  Plug 'neoclide/coc.nvim', {'branch': 'release'}
call plug#end()
```

ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã«é–¢ã™ã‚‹è¨˜è¿°ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚
ãã‚Œãã‚Œä»¥ä¸‹ã®ç”¨é€”ã€‚
- rust.vim: è‡ªå‹•æ•´å½¢ï¼ˆäº‹å‰ã«`rustfmt`ã‚’`rustup`ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãŠãã“ã¨ï¼‰
- coc.nvim: rust-analyzer 

- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Neovimã‚’é–‹ã„ã¦ï¼ˆä½•ã§ã‚‚ã‚ˆã„ï¼‰ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚

```bash
PlugInstall
```

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†å¾Œã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç¢ºèªã—ã€OKã§ã‚Œã°æ­£å¸¸ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã€‚

```bash
PlugStatus
```

### rust-analyzer ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Neovimã‚’é–‹ã„ã¦ï¼ˆä½•ã§ã‚‚ã‚ˆã„ï¼‰ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚

```bash
CocInstall coc-rust-analyzer
```

### init.vimè¨­å®š

`init.vim`ã«ä½•ã‚‚è¨­å®šã—ãªã„ã¨ã€ä½¿ç”¨ã—ãšã‚‰ã„ã®ã§ã€ã‚¿ãƒ–é¸æŠã§ãã‚‹ã‚ˆã†ã«ã—ãŸã‚Šã€ä¿å­˜æ™‚ã«è‡ªå‹•æ•´å½¢ã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚

```vim
call plug#begin('~/.vim/plugged')
  Plug 'rust-lang/rust.vim'
  Plug 'neoclide/coc.nvim', {'branch': 'release'}
call plug#end()

syntax enable
filetype plugin indent on

" rust auto format
let g:rustfmt_autosave = 1

set number

" Having longer updatetime (default is 4000 ms = 4 s) leads to noticeable
" delays and poor user experience.
set updatetime=300

" Always show the signcolumn, otherwise it would shift the text each time
" diagnostics appear/become resolved.
if has("patch-8.1.1564")
  " Recently vim can merge signcolumn and number column into one
  set signcolumn=number
else
  set signcolumn=yes
endif

" Make <CR> auto-select the first completion item and notify coc.nvim to
" format on enter, <cr> could be remapped by other vim plugin
inoremap <silent><expr> <cr> pumvisible() ? coc#_select_confirm()
                              \: "\<C-g>u\<CR>\<c-r>=coc#on_enter()\<CR>"

inoremap <silent> jj <ESC>
noremap <Space>s :<C-u>w<CR>
```

# fish shell ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
sudo apt-add-repository ppa:fish-shell/release-3
```

```bash
sudo apt-get update
```

```bash
sudo apt-get install fish
```

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèªã—ã¦ã€æ­£å¸¸ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã€‚

```bash
fish -v
```

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚·ã‚§ãƒ«ã‚’å¤‰æ›´ã€‚

```bash
chsh
```

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ä»¥ä¸‹ã‚’è¨­å®šã€‚

```bash
/usr/bin/fish
```

ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’å†èµ·å‹•ã€ã¾ãŸã¯ã€ã‚¿ãƒ–ã§æ–°è¦èµ·å‹•ã™ã‚‹ã¨ã€`fish shell`ãŒã§ãã‚ˆã†ã•ã‚Œã‚‹ã€‚

å‚è€ƒï¼š
https://qiita.com/koji9412/items/7e2a15c330c387fc5b3b


åˆæœŸè¨­å®šã ã¨ã€`cargo`ã®ç’°å¢ƒãƒ‘ã‚¹ãŒé€šã£ã¦ã„ãªã„ã®ã§ã€æ‰‹å‹•ã§ãƒ‘ã‚¹ã‚’é€šã™å¿…è¦ãŒã‚ã‚‹ã€‚

```bash
fish_add_path $HOME/.cargo/bin
```