---
title: "AHC031 Event Hall 復習記"
emoji: "🏃"
type: "tech"
topics: ["rust", "AtCoder"]
published: false
---

問題の内容は以下を参照。

https://atcoder.jp/contests/ahc031/tasks/ahc031_a


コンテストの結果は以下の通りで、個人的には苦い結果でした。
私の方針は、本質的ではなく、かつ順位もあまり良くないので、解説はしませんが、以下では、本質的な方針で復習してみたので、その記録を残します。この記事は、解説ではなく、正しくないことを書いている可能性があるので、鵜呑みにせず自分なりに納得のいく考察をすることをオススメします。間違いがあったらコメントで教えていただけると助かります。

![Document](/images/ahc031/contest_result.png)


# 固定パーティション位置ランダム解

## 方針

日付が変わっても移動しない、固定のパーティションがあれば、その分の移動コストを減らすことができるので、このパーティションの数を可能な限り多く設定するような置き方について考えます。ただ、どのようにパーティションを置けば良いかよく分からないので、適当にランダムにパーティションを設定して、何回も繰り返すことで解がないかトライする、という方針で書いてみます。パーティションは1から解が見つかる度に増やしていきます。
また、パーティションを決定した後、解が存在するかはビンパッキング問題を解くことで判断しています。ビンパッキング問題の解き方としては、以下の貪欲としました。
1. 大きい方から順番にビンに入れていく（大きい方が入られるビンの候補が少ないので、後で入れられなくならないように先に決定する）
2. ビンに入れたときに、高さが最も低くなるビンに入れる（まんべんなくビンに入れた方が後に入れるビン候補の選択肢が広がる）

この貪欲は最適解ではないので、いくつか貪欲のパターンを考えてみると良いかもしれません。例えば・・・
- 入れられるビンのうち、四角形の縦横比が最小になる貪欲（四角形で領域を確保する都合上、余分な領域が出てくるが、この余剰分を少なくするような貪欲）


## 結果

提出コードは以下。**39AC/11WA**ですが、点数は**4.78G**で、既に自分がコンテストに提出した点数を上回りました。。。提出コードを見てもらえば分かるのですが、実装量は大したことはありません。筋のいい方針は実装が簡単になる傾向にあるように思います。ちなみに、WAの原因は解が見つからなかったパターンがあるときに発生しているようです。

https://atcoder.jp/contests/ahc031/submissions/52473890

参考に**seed=5**のビジュアライザを載せておきます。スコアは**94,348**でした。

![Document](/images/ahc031/random_vis.gif)

## 改善

上述のランダム解法ですが、パーティションの数の上限を見つけていますが、その後、探索はせず、1つだけ見つかった解を出力しているだけです。パーティションの上限が決まったら、その上限の中でもスコアの良いものを時間いっぱい回して、探索したい、という気持ちなります。相変わらず、ランダムでパーティションを決めていますが、スコアが改善したら、更新という方針でコードを書きました。
同じコードを流用するので、いくつかのコードを関数化しています。

提出コードは以下。**39AC/11TLE**ですが、点数は**6.01G**でした。そこそこの改善です。見栄えは変わらないので、ビジュアライザは載せませんが、**seed=5**の時のスコアは**84,081**でした。

https://atcoder.jp/contests/ahc031/submissions/52500151