---
title: "【ワイ記法解説】AtCoder ABC280 D"
emoji: 🏃
type: "tech"
topics: ["rust", "AtCoder", "競プロ"]
published: true
---

ABC280 C判定「WJ...」

ABC280 C判定「AC!!」

ワイ「よっしゃ！次D問題や！」
https://atcoder.jp/contests/abc280/tasks/abc280_d

ワイ「...ふむふむ」

ワイ「ほーん...」

ワイ「うわぁ。あかん...苦手な整数問題や...」

ワイ「よう分からんから、とりあえず一旦実験してみよか！」

ワイ「例えば$K=30$のとき...」

ワイ「$1!=1$、$2!=2\times1=2$、$3!=3\times2\times1=6$、$4!=4\times3\times2\times1=24$、$5!=5\times4\times3\times2\times1=120$」

ワイ「...120は30の倍数やから、このときは5が答えやな！理解！理解！」

ワイ「ということは...」

ワイ「せや！！$N!$が$K$の素因数を全てもっていれば倍数になりそうやから、まずは素因数分解しそうな気がする！」

ワイ「$30$を素因数分解すると、$2\times3\times5$」

ワイ「で？この後どうするんや...」

ワイ「...」

ワイ「何もおもいつかへん...」

ワイ「ちょっと別視点で考えてみよか！」

ワイ「Kを1から順番に、割り切れるなら割って、+1インクリメントして...を繰り返して最終的にKが1になったときの値が最小のNなのでは？」

ワイ「あと、割る値は素因数分解して、素因数ごとに、割れるか判定して割ってあげないといかんな！」

ワイ「...よし！書けた！これでどうや？」

ABC280 判定「...TLEやでー。やり直しやでー。」

ワイ「はぁ？？？どういうことや？」

ワイ「は！Kがめっちゃ大きくて、素数やったら制約が$10^{12}$やらから計算終わらへんやんけ！」

ワイ「$10^{12}$の素因数の中で一番大きいのは、$10^{6}$以下やから、これを超える場合、Kをそのまま出力すればええんや！」

ワイ「...よし！書けた！次こそどうや？」

ABC280 判定「...WAやでー。やり直しやでー。」

ワイ「はぁ？？？」

ワイ「わけわかめすぎや！！」

ワイ「...」

AtCoder「コンテスト終了やでー。もう諦めるんやでー。」

ワイ「はぁ...今回も4完でけへんかった...」

ワイ「とりあえず答え見て復習しよかー」
https://atcoder.jp/contests/abc280/editorial/5330

解説「まずKを素因数分解するやでー」

ワイ「ほーほーここまでは最初に考えたのと合っとるな！」

解説「そいで、${N_i}!$が${p_i}^{a_i}$の倍数となる最小の${N_i}!$を求めるやでー。ニチャア。」

ワイ「解説ニチャリすぎ！きっしょ！」

ワイ「もう寝るわ！」

翌日...

ワイ「よし！昨日の復習でもするか！」

解説「${N_i}!$が${p_i}^{a_i}$の倍数となる最小の${N_i}!$を求めるやでー。ニチャア。」

ワイ「pが素因数で...aがその個数か...」

ワイ「iってなんや...」

ワイ「せや！各素因数ごとにって意味か！」

ワイ「各素因数について、素因数の個数乗の倍数になる最小の$N!$を計算するってことか！」

ワイ「そいで、それらの最大を取ればええんか！」

ワイ「でも、どうやって計算するやろ...コード見てみるか...」

ワイ「n += pってなんや？」

ワイ「...」

ワイ「例えばp=2のときは、2, 4, 6, 8...ってなるなぁ」

ワイ「なるほど。当たり前やけど、確かに、素因数の倍数にしか、その素因数は含まれんなぁ」

ワイ「せやからnにどんどんpを足して、pの倍数をつくってるんやなぁ」

ワイ「せやけど、最低1個は含まれているけど、4とか8は複数含まれてんなぁ」

ワイ「その場合は...」

ワイ「あ！せやからxをpで割り切れなくなるまで割って個数数えてるんか！」

ワイ「その個数が、aになったときのnが答えになるんか！」

ワイ「はぇーー賢いなぁ！」

ワイ「他の解説も見てみるか！」
https://atcoder.jp/contests/abc280/editorial/5348

解説「ルジャンドルの定理より、$n!$が素数$p$で割り切れる数を求められるやでー」

解説「二分探索するんやでー」

ワイ「なんや！そんなんあるんか！」

ワイ「任意の$n!$で各素因数について割り切れる個数を求められるんやらか、その結果がKを素因数分解したものを満たす境目を二分探索するんか！」

ワイ「1から順番に条件を満たすまで計算してったら、Kの制約でTLEになるし、あるnを境にKの倍数になることは確定するから二分探索することは理に適っとるんや！」

ワイ「これも賢いなぁ！」

ワイ「もう1個解説あるなぁ。見てみよかー」
https://atcoder.jp/contests/abc280/editorial/5333

ワイ「...ん！？これってワイが解答したやり方に少し似てへんか？WAやったけど...」

解説「k /= gcd(k, i)」

ワイ「なんやこれ？？」

ワイ「...」

ワイ「！！」

ワイ「ワイは割る数を素因数分解して、素因数ごとに割れたら割ってたんやけど、それって共通の素因数、つまり最大公約数なんやから、そんなことする必要あらへんやん！アホすぎ！」

ワイ「共通の素因数がなければ、最大公約数は1やからkは変化しないし...」

ワイ「なんや最大公約数で割ると、一石二鳥やんけ！天才かよ！」

ワイ「せやけどワイの解答がWAになった理由はここにはあらへんなぁ」

ワイ「 ...探索する上限が$10^{6}$やなくて、$2\times10^{6}$ってなんや？」

ワイ「$\sqrt{K}$で良さそうやけどなぁ」

ワイ「...」

ワイ「なんかKが平方数のとき、あやしいなぁ！」

ワイ「例えばK=4のとき、探索する上限を$\sqrt{4}$としたら、上限2までやから、1にならへんなぁ」

ワイ「せやから2倍して、$\sqrt{K}$を素因数にもつ次の値が$2\sqrt{K}$で、それが上限なんかぁ」

ワイ「それぞれコード書いてACとっとくか！！」

ワイ「...」

判定「...AC」

ワイ「よっしゃ！これで復習終わりや！」

ワイ「今回のD問題は色々勉強になって良問やったなぁ」

ワイ「次は4完するでぇ！！！」

完

解答例(Rust)は以下。
https://github.com/TatsuyaYoke/atcoder/tree/master/abc280/src/bin